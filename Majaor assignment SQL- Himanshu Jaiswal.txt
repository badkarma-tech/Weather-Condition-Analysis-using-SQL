CREATE TABLE Station (
    IDNumber INT PRIMARY KEY,
    CITY CHAR(20),
    STATE CHAR(2),
    LAT_N DECIMAL(9,6),
    LONG_W DECIMAL(9,6)
);

INSERT INTO Station (IDNumber, CITY, STATE, LAT_N, LONG_W)
VALUES (13, 'PHOENIX', 'AZ', 33, 112);

INSERT INTO Station (IDNumber, CITY, STATE, LAT_N, LONG_W)
VALUES  (44, 'DENVER', 'CO', 40, 105);

INSERT INTO Station (IDNumber, CITY, STATE, LAT_N, LONG_W)
VALUES  (66, 'CARIBOU', 'ME', 47, 68);

SELECT * FROM Station;

SELECT * FROM Station
WHERE LAT_N > 39.7;

CREATE TABLE STATS (
    IDNumber INT,
    MONTH INT,
    TEMP_F DECIMAL(5,1),
    RAIN_IN DECIMAL(5,3),
    PRIMARY KEY (IDNumber, MONTH),
    FOREIGN KEY (IDNumber) REFERENCES Station (IDNumber)
);


INSERT INTO STATS (IDNumber, MONTH, TEMP_F, RAIN_IN)
VALUES (13, 1, 57.4, .31);

INSERT INTO STATS (IDNumber, MONTH, TEMP_F, RAIN_IN)
VALUES (13, 7, 91.75, 5.15);

INSERT INTO STATS (IDNumber, MONTH, TEMP_F, RAIN_IN)
VALUES (13, 1, 27.3, .18);

UPDATE STATS
SET TEMP_F = 27.3, RAIN_IN = 0.18
WHERE IDNumber = 13 AND MONTH = 1;


INSERT INTO STATS (IDNumber, MONTH, TEMP_F, RAIN_IN)
VALUES (44, 7, 74.8, 2.11);

INSERT INTO STATS (IDNumber, MONTH, TEMP_F, RAIN_IN)
VALUES (44, 1, 27.3, .18);

INSERT INTO STATS (IDNumber, MONTH, TEMP_F, RAIN_IN)
VALUES (66, 7, 65.8, 4.52);

SELECT S.CITY, MIN(ST.TEMP_F) AS MIN_TEMP, MAX(ST.TEMP_F) AS MAX_TEMP, AVG(ST.TEMP_F) AS AVG_TEMP
FROM STATS ST
JOIN STATION S ON ST.IDNumber = S.IDNumber
GROUP BY S.CITY;

SELECT S.CITY, ST.MONTH, ST.RAIN_IN, ST.TEMP_F
FROM STATS ST
JOIN STATION S ON ST.IDNumber = S.IDNumber
ORDER BY ST.MONTH, ST.RAIN_IN DESC;

SELECT S.CITY, S.LAT_N, ST.TEMP_F
FROM STATS ST
JOIN STATION S ON ST.IDNumber = S.IDNumber
WHERE ST.MONTH = 7
ORDER BY ST.TEMP_F ASC;

SELECT S.CITY, MAX(ST.TEMP_F) AS MAX_TEMP, MIN(ST.TEMP_F) AS MIN_TEMP, AVG(ST.RAIN_IN) AS AVG_RAINFALL
FROM STATS ST
JOIN STATION S ON ST.IDNumber = S.IDNumber
GROUP BY S.CITY;

SELECT S.CITY, ST.MONTH,
       (ST.TEMP_F - 32) * 5/9 AS TEMP_CELSIUS,
       ST.RAIN_IN * 2.54 AS RAIN_CM
FROM STATS ST
JOIN STATION S ON ST.IDNumber = S.IDNumber;

UPDATE STATS
SET RAIN_IN = RAIN_IN + 0.01;

UPDATE STATS
SET TEMP_F = 74.9
WHERE IDNumber = (SELECT IDNumber FROM STATION WHERE CITY = 'Denver') AND MONTH = 7;
